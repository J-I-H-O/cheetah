> CPU 코어에서 실행 중이던 프로세스/스레드가 다른 프로세스/스레드로 교체되는 것
> 

### 컨텍스트란

프로세스/스레드의 상태

### 컨텍스트 스위칭은 왜 필요한가?

여러 프로세스/스레드를 동시에 실행시키기 위해서

### 언제 발생하는가?

다른 프로세스/스레드가 CPU자원을 필요로 할 때

1. 주어진 time slice(quantum)을 다 사용한 경우
2. IO작업을 해야하는 경우
3. 다른 리소스를 기다려야 하는 경우
4. 그 외 여러가지..

### 컨텍스트 스위칭 동작과정

컨텍스트 스위칭이 발생하면, 현재 작업중인 프로세스의 PCB에 현재 상태를 백업해두게 됩니다. 이후, 다음 프로세스 작업의 PCB를 CPU에 복원하여 작업을 그대로 수행한다.

PCB(Process Control Block)에는 프로세스 ID, 레지스터 값, 프로세스 상태, CPU 스케쥴링 정보, 프로세스 메모리 위치와 같이 프로세스를 제어하기 위한 데이터가 저장된다.

### 프로세스 컨텍스트 스위칭 & 스레드 컨텍스트 스위칭 공통점

1. 커널 모드에서 실행된다.
2. CPU의 레지스터 상태를 교체한다
    1. 레지스터는 각종 명령어를 실행하기위해 값들을 저장하는 곳
    2. 컨텍스트 스위칭 되기전에 레지스터 상태를 어딘가에 저장해놓아야 다시 돌아와서 작업이 가능하다.

### 프로세스 컨텍스트 스위칭 & 스레드 컨텍스트 스위칭 차이점

프로세스 컨텍스트 스위칭은 가상 메모리 주소 관련 처리를 추가로 수행해야한다.

스레드의 경우 같은 프로세스를 사용하기에 같은 가상 메모리 주소를 공유하고 있다. 그렇기 때문에 스레드 레지스터 상태, 스택영역만 교체하면 되기에 오버헤드가 작다.

### 가상 메모리 주소 관련 처리하면 왜 오버헤드가 큰가?

가상 메모리 공간 변경을 위한 별도 처리가 생기면 오버헤드가 커지는 근본적인 원인은 TLB에 있다.

TLB(Translation Lookaside Buffer)는 CPU가 페이지 테이블을 참조해야하는 단점을 보완하는 캐시.

프로세스 컨텍스트 스위칭은 TLB를 플러시하여 비우기 때문에, 다시 TLB를 채워나가야 하는 추가적인 오버헤드를 발생시킨다.
